<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实用资源导航 - 一站式工具集合</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-bg: #f5f7fa;
            --dark-bg: #2c3e50;
            --text-color: #333;
            --text-light: #777;
            --border-color: #ddd;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        .dark-theme {
            --light-bg: #2c3e50;
            --dark-bg: #1a2530;
            --text-color: #ecf0f1;
            --text-light: #bdc3c7;
            --border-color: #34495e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            transition: var(--transition);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 按钮样式 */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        /* 头部样式 */
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .description {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: 20px;
        }

        .user-controls {
            position: absolute;
            top: 0;
            right: 0;
        }

        /* 搜索栏样式 */
        .search-container {
            display: flex;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border-radius: 30px;
            overflow: hidden;
        }

        .search-box {
            flex: 1;
            padding: 15px 20px;
            border: none;
            font-size: 16px;
            outline: none;
        }

        .search-btn {
            padding: 0 25px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        /* 分类样式 */
        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .category {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .category:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .category-title {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .category-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
        }

        .category h2 {
            font-size: 1.4rem;
        }

        .links {
            list-style: none;
        }

        .link-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            transition: var(--transition);
        }

        .link-item:hover {
            background-color: #f9f9f9;
            padding-left: 10px;
        }

        .link-item:last-child {
            border-bottom: none;
        }

        .link-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--primary-color);
            font-size: 18px;
        }

        .link-content {
            flex: 1;
        }

        .link-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .link-description {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* 个人中心样式 */
        .profile-section {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 1000;
            display: none;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        .profile-section.active {
            display: block;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
        }

        .profile-title {
            font-size: 1.5rem;
        }

        .profile-content {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .profile-sidebar {
            width: 250px;
            background-color: #f5f7fa;
            border-right: 1px solid var(--border-color);
        }

        .profile-nav {
            list-style: none;
            padding: 20px 0;
        }

        .profile-nav li {
            margin-bottom: 5px;
        }

        .profile-nav a {
            display: block;
            padding: 12px 20px;
            color: var(--text-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .profile-nav a:hover,
        .profile-nav a.active {
            background-color: var(--primary-color);
            color: white;
        }

        .profile-main {
            flex: 1;
            padding: 20px;
        }

        .profile-tab {
            display: none;
        }

        .profile-tab.active {
            display: block;
        }

        .user-info-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #f5f7fa;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            color: white;
            font-size: 30px;
        }

        .user-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            background-color: #f5f7fa;
            border-radius: 8px;
            flex: 1;
            margin: 0 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* 模态框样式 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1100;
            display: none;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.3rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }

        .modal-body {
            padding: 20px;
        }

        /* 主题切换 */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }

        .theme-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        /* 登录提示信息样式 */
        .login-message {
            color: #e74c3c;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            min-height: 20px;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .categories {
                grid-template-columns: 1fr;
            }
            
            .profile-content {
                flex-direction: column;
            }
            
            .profile-sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            .profile-nav {
                display: flex;
                overflow-x: auto;
                padding: 10px 0;
            }
            
            .profile-nav li {
                margin-bottom: 0;
                margin-right: 10px;
            }
            
            .profile-nav a {
                white-space: nowrap;
            }
            
            .user-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat-card {
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 搜索栏 -->
        <div class="search-container">
            <input type="text" class="search-box" id="searchInput" placeholder="搜索资源、工具或网站...">
            <button class="search-btn" id="searchBtn">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <header>
            <div class="user-controls">
                <button id="userBtn" class="btn btn-primary">
                    <i class="fas fa-user"></i> 登录/注册
                </button>
            </div>
            <h1>实用资源导航</h1>
            <p class="description">精心挑选的实用网站与工具，提高工作效率与生活质量</p>
        </header>

        <!-- 个人中心区域 -->
        <div id="profileSection" class="profile-section">
            <div class="profile-header">
                <h2 class="profile-title">个人中心</h2>
                <button id="closeProfile" class="btn btn-danger">
                    <i class="fas fa-times"></i> 关闭
                </button>
            </div>
            <div class="profile-content">
                <div class="profile-sidebar">
                    <ul class="profile-nav">
                        <li><a href="#profile-info" class="active" data-tab="info">个人信息</a></li>
                        <li><a href="#profile-favorites" data-tab="favorites">我的收藏</a></li>
                        <li><a href="#profile-history" data-tab="history">浏览历史</a></li>
                        <li><a href="#profile-settings" data-tab="settings">账户设置</a></li>
                        <li><a href="#profile-logout" data-tab="logout">退出登录</a></li>
                    </ul>
                </div>
                <div class="profile-main">
                    <div id="infoTab" class="profile-tab active">
                        <div class="user-info-card">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3 id="profileUserName">用户名</h3>
                            <p id="profileUserEmail">邮箱</p>
                            <p id="profileUserRole">普通用户</p>
                        </div>
                        <div class="user-stats">
                            <div class="stat-card">
                                <div class="stat-value" id="blogsCount">0</div>
                                <div class="stat-label">收藏的网站</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="linksCount">0</div>
                                <div class="stat-label">访问次数</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="joinDays">0</div>
                                <div class="stat-label">加入天数</div>
                            </div>
                        </div>
                    </div>

                    <div id="favoritesTab" class="profile-tab">
                        <h3>我的收藏</h3>
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="搜索收藏内容...">
                        </div>
                        <ul class="links" id="favoritesList">
                            <!-- 收藏内容将通过JavaScript动态加载 -->
                        </ul>
                    </div>

                    <div id="historyTab" class="profile-tab">
                        <h3>浏览历史</h3>
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="搜索浏览历史...">
                        </div>
                        <ul class="links" id="historyList">
                            <!-- 浏览历史将通过JavaScript动态加载 -->
                        </ul>
                    </div>

                    <div id="settingsTab" class="profile-tab">
                        <h3>账户设置</h3>
                        <form id="profileSettingsForm">
                            <div class="form-group">
                                <label for="profileUsername">用户名</label>
                                <input type="text" id="profileUsername" class="form-control" disabled>
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">邮箱</label>
                                <input type="email" id="profileEmail" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="profileJoinDate">注册日期</label>
                                <input type="text" id="profileJoinDate" class="form-control" disabled>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-success">保存设置</button>
                            </div>
                        </form>
                    </div>

                    <div id="logoutTab" class="profile-tab">
                        <h3>退出登录</h3>
                        <p>确定要退出当前账号吗？</p>
                        <div class="form-actions">
                            <button id="confirmLogout" class="btn btn-danger">确定退出</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 用户登录/注册模态框 -->
        <div id="userModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="userModalTitle">用户登录</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <div class="form-group">
                            <label for="username">用户名</label>
                            <input type="text" id="username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="password">密码</label>
                            <input type="password" id="password" class="form-control" required>
                        </div>
                        <div class="form-group" id="emailGroup" style="display: none;">
                            <label for="email">邮箱</label>
                            <input type="email" id="email" class="form-control">
                        </div>
                        <div class="login-message" id="loginMessage"></div>
                        <div class="form-actions">
                            <button type="button" id="switchMode" class="btn btn-warning">切换到注册</button>
                            <button type="submit" class="btn btn-success">登录</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 资源分类 -->
        <div class="categories">
            <!-- 工具分类 -->
            <div class="category tools" data-category="tools">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-tools"></i></div>
                    <h2>工具</h2>
                </div>
                <ul class="links" id="tools-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>

            <!-- AI分类 -->
            <div class="category ai" data-category="ai">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-robot"></i></div>
                    <h2>AI</h2>
                </div>
                <ul class="links" id="ai-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>

            <!-- 视频分类 -->
            <div class="category video" data-category="video">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-video"></i></div>
                    <h2>视频</h2>
                </div>
                <ul class="links" id="video-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>

            <!-- 游戏分类 -->
            <div class="category games" data-category="games">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-gamepad"></i></div>
                    <h2>游戏</h2>
                </div>
                <ul class="links" id="games-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>

            <!-- 代理分类 -->
            <div class="category proxy" data-category="proxy">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-globe"></i></div>
                    <h2>代理</h2>
                </div>
                <ul class="links" id="proxy-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>

            <!-- 学习分类 -->
            <div class="category learning" data-category="learning">
                <div class="category-title">
                    <div class="category-icon"><i class="fas fa-graduation-cap"></i></div>
                    <h2>学习</h2>
                </div>
                <ul class="links" id="learning-links">
                    <!-- 链接将通过JavaScript动态加载 -->
                </ul>
            </div>
        </div>
    </div>

    <!-- 主题切换按钮 -->
    <div class="theme-toggle">
        <button class="theme-btn" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <script>
        // 示例数据
        const sampleLinks = {
            tools: [
                { title: "GitHub", description: "全球最大的代码托管平台", url: "https://github.com", icon: "fab fa-github" },
                { title: "Stack Overflow", description: "程序员问答社区", url: "https://stackoverflow.com", icon: "fab fa-stack-overflow" },
                { title: "CodePen", description: "前端代码在线编辑与展示", url: "https://codepen.io", icon: "fab fa-codepen" },
                { title: "Canva", description: "在线设计工具", url: "https://canva.com", icon: "fas fa-palette" }
            ],
            ai: [
                { title: "ChatGPT", description: "OpenAI的对话AI", url: "https://chat.openai.com", icon: "fas fa-robot" },
                { title: "Midjourney", description: "AI图像生成工具", url: "https://midjourney.com", icon: "fas fa-palette" },
                { title: "Hugging Face", description: "AI模型分享平台", url: "https://huggingface.co", icon: "fas fa-brain" },
                { title: "Claude", description: "Anthropic的AI助手", url: "https://claude.ai", icon: "fas fa-comment" }
            ],
            video: [
                { title: "YouTube", description: "全球最大的视频分享平台", url: "https://youtube.com", icon: "fab fa-youtube" },
                { title: "Bilibili", description: "国内知名视频弹幕网站", url: "https://bilibili.com", icon: "fas fa-play-circle" },
                { title: "Netflix", description: "全球流媒体服务平台", url: "https://netflix.com", icon: "fas fa-film" },
                { title: "Vimeo", description: "高质量视频分享平台", url: "https://vimeo.com", icon: "fas fa-video" }
            ],
            games: [
                { title: "Steam", description: "全球最大的游戏平台", url: "https://store.steampowered.com", icon: "fab fa-steam" },
                { title: "Epic Games", description: "知名游戏发行平台", url: "https://epicgames.com", icon: "fas fa-gamepad" },
                { title: "NVIDIA GeForce Now", description: "云游戏服务平台", url: "https://nvidia.com/geforce-now", icon: "fas fa-cloud" },
                { title: "itch.io", description: "独立游戏平台", url: "https://itch.io", icon: "fas fa-gamepad" }
            ],
            proxy: [
                { title: "Clash", description: "规则驱动的代理客户端", url: "https://github.com/Dreamacro/clash", icon: "fas fa-shield-alt" },
                { title: "V2Ray", description: "网络代理工具", url: "https://v2ray.com", icon: "fas fa-network-wired" },
                { title: "Shadowsocks", description: "轻量级代理工具", url: "https://shadowsocks.org", icon: "fas fa-user-secret" }
            ],
            learning: [
                { title: "Coursera", description: "在线课程平台", url: "https://coursera.org", icon: "fas fa-graduation-cap" },
                { title: "Khan Academy", description: "免费在线学习资源", url: "https://khanacademy.org", icon: "fas fa-book" },
                { title: "Duolingo", description: "语言学习应用", url: "https://duolingo.com", icon: "fas fa-language" },
                { title: "Wikipedia", description: "免费的百科全书", url: "https://wikipedia.org", icon: "fab fa-wikipedia-w" }
            ]
        };

        // 管理员账户
        const adminAccount = {
            username: "waduck",
            password: "w1847236328",
            role: "admin"
        };

        // 当前用户状态
        let currentUser = null;

        // 用户数据存储
        let usersData = JSON.parse(localStorage.getItem('usersData')) || {};
        let userLinks = JSON.parse(localStorage.getItem('userLinks')) || {};
        
        // 记忆功能 - 保存当前登录用户
        let rememberedUser = JSON.parse(localStorage.getItem('rememberedUser'));

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 检查是否有记忆的登录用户
            if (rememberedUser) {
                currentUser = rememberedUser;
                updateUIForLoggedInUser();
            }
            
            // 加载链接数据
            loadLinks();
            
            // 初始化事件监听器
            initEventListeners();
        });

        // 更新UI为已登录状态
        function updateUIForLoggedInUser() {
            if (currentUser) {
                document.getElementById('userBtn').innerHTML = `<i class="fas fa-user"></i> ${currentUser.username}`;
            }
        }

        // 加载链接数据
        function loadLinks() {
            for (const category in sampleLinks) {
                const linksContainer = document.getElementById(`${category}-links`);
                if (linksContainer) {
                    // 如果有用户登录且该用户有自定义链接，则使用用户自定义链接
                    const userCategoryLinks = currentUser && userLinks[currentUser.username] ? 
                        userLinks[currentUser.username][category] : null;
                    
                    const linksToShow = userCategoryLinks || sampleLinks[category];
                    
                    linksContainer.innerHTML = '';
                    
                    // 加载链接
                    linksToShow.forEach((link, index) => {
                        const linkItem = document.createElement('li');
                        linkItem.className = 'link-item';
                        linkItem.setAttribute('data-category', category);
                        linkItem.setAttribute('data-index', index);
                        linkItem.innerHTML = `
                            <div class="link-icon">
                                <i class="${link.icon}"></i>
                            </div>
                            <div class="link-content">
                                <div class="link-title">${link.title}</div>
                                <div class="link-description">${link.description}</div>
                            </div>
                        `;
                        linkItem.addEventListener('click', (e) => {
                            window.open(link.url, '_blank');
                        });
                        linksContainer.appendChild(linkItem);
                    });
                }
            }
        }

        // 初始化事件监听器
        function initEventListeners() {
            // 主题切换
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // 用户按钮
            document.getElementById('userBtn').addEventListener('click', showUserModal);
            
            // 关闭个人中心
            document.getElementById('closeProfile').addEventListener('click', hideProfile);
            
            // 切换登录/注册模式
            document.getElementById('switchMode').addEventListener('click', switchUserMode);
            
            // 关闭模态框
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('active');
                });
            });
            
            // 个人中心标签切换
            document.querySelectorAll('.profile-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 更新活动标签
                    document.querySelectorAll('.profile-nav a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 显示对应标签页
                    const tabId = this.getAttribute('data-tab');
                    document.querySelectorAll('.profile-tab').forEach(tab => tab.classList.remove('active'));
                    document.getElementById(`${tabId}Tab`).classList.add('active');
                });
            });
            
            // 表单提交
            document.getElementById('userForm').addEventListener('submit', handleUserFormSubmit);
            document.getElementById('profileSettingsForm').addEventListener('submit', handleProfileSettingsSubmit);
            
            // 退出登录
            document.getElementById('confirmLogout').addEventListener('click', handleLogout);
        }

        // 主题切换
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const icon = document.querySelector('#themeToggle i');
            if (document.body.classList.contains('dark-theme')) {
                icon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
            } else {
                icon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
            }
        }

        // 显示用户模态框
        function showUserModal() {
            if (currentUser) {
                // 如果已登录，直接显示个人中心
                showProfile();
            } else {
                document.getElementById('userModal').classList.add('active');
                // 清空登录消息
                document.getElementById('loginMessage').textContent = '';
            }
        }

        // 显示个人中心
        function showProfile() {
            document.getElementById('profileSection').classList.add('active');
            
            if (currentUser) {
                // 更新用户信息
                document.getElementById('profileUserName').textContent = currentUser.username;
                document.getElementById('profileUserEmail').textContent = currentUser.email || '未设置邮箱';
                document.getElementById('profileUserRole').textContent = currentUser.role === 'admin' ? '管理员' : '普通用户';
                document.getElementById('profileUsername').value = currentUser.username;
                document.getElementById('profileEmail').value = currentUser.email || '';
                document.getElementById('profileJoinDate').value = currentUser.joinDate || '2023-05-15';
                
                // 更新统计数据
                document.getElementById('blogsCount').textContent = currentUser.blogsCount || '0';
                document.getElementById('linksCount').textContent = currentUser.linksCount || '0';
                document.getElementById('joinDays').textContent = currentUser.joinDays || '245';
                
                // 更新用户按钮
                document.getElementById('userBtn').innerHTML = `<i class="fas fa-user"></i> ${currentUser.username}`;
            }
        }

        // 隐藏个人中心
        function hideProfile() {
            document.getElementById('profileSection').classList.remove('active');
        }

        // 切换用户模式（登录/注册）
        function switchUserMode() {
            const title = document.getElementById('userModalTitle');
            const switchBtn = document.getElementById('switchMode');
            const submitBtn = document.querySelector('#userForm button[type="submit"]');
            const emailGroup = document.getElementById('emailGroup');
            
            // 清空登录消息
            document.getElementById('loginMessage').textContent = '';
            
            if (title.textContent === '用户登录') {
                title.textContent = '用户注册';
                switchBtn.textContent = '切换到登录';
                submitBtn.textContent = '注册';
                emailGroup.style.display = 'block';
            } else {
                title.textContent = '用户登录';
                switchBtn.textContent = '切换到注册';
                submitBtn.textContent = '登录';
                emailGroup.style.display = 'none';
            }
        }

        // 处理用户表单提交
        function handleUserFormSubmit(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const email = document.getElementById('email').value;
            const isLoginMode = document.getElementById('userModalTitle').textContent === '用户登录';
            const loginMessage = document.getElementById('loginMessage');
            
            if (isLoginMode) {
                // 登录逻辑
                if (username === adminAccount.username && password === adminAccount.password) {
                    currentUser = {
                        username: adminAccount.username,
                        role: adminAccount.role,
                        email: 'admin@example.com',
                        joinDate: '2023-01-01',
                        blogsCount: '11',
                        linksCount: '5',
                        joinDays: '245'
                    };
                    
                    // 记忆登录状态
                    localStorage.setItem('rememberedUser', JSON.stringify(currentUser));
                    
                    loginMessage.textContent = '管理员登录成功！';
                    loginMessage.style.color = '#2ecc71'; // 成功时显示绿色
                    setTimeout(() => {
                        document.getElementById('userModal').classList.remove('active');
                        updateUIForLoggedInUser();
                        showProfile();
                    }, 1000);
                } else if (usersData[username] && usersData[username].password === password) {
                    currentUser = {
                        username: username,
                        role: 'user',
                        email: usersData[username].email,
                        joinDate: usersData[username].joinDate,
                        blogsCount: usersData[username].blogsCount || '0',
                        linksCount: usersData[username].linksCount || '0',
                        joinDays: usersData[username].joinDays || '1'
                    };
                    
                    // 记忆登录状态
                    localStorage.setItem('rememberedUser', JSON.stringify(currentUser));
                    
                    loginMessage.textContent = '登录成功！';
                    loginMessage.style.color = '#2ecc71'; // 成功时显示绿色
                    setTimeout(() => {
                        document.getElementById('userModal').classList.remove('active');
                        updateUIForLoggedInUser();
                        showProfile();
                    }, 1000);
                } else {
                    loginMessage.textContent = '用户名或密码错误！';
                    loginMessage.style.color = '#e74c3c'; // 失败时显示红色
                }
            } else {
                // 注册逻辑
                if (usersData[username]) {
                    loginMessage.textContent = '用户名已存在！';
                    loginMessage.style.color = '#e74c3c';
                } else {
                    usersData[username] = {
                        password: password,
                        email: email,
                        joinDate: new Date().toISOString().split('T')[0],
                        blogsCount: '0',
                        linksCount: '0',
                        joinDays: '1'
                    };
                    localStorage.setItem('usersData', JSON.stringify(usersData));
                    
                    currentUser = {
                        username: username,
                        role: 'user',
                        email: email,
                        joinDate: new Date().toISOString().split('T')[0],
                        blogsCount: '0',
                        linksCount: '0',
                        joinDays: '1'
                    };
                    
                    // 记忆登录状态
                    localStorage.setItem('rememberedUser', JSON.stringify(currentUser));
                    
                    loginMessage.textContent = '注册成功！';
                    loginMessage.style.color = '#2ecc71';
                    setTimeout(() => {
                        document.getElementById('userModal').classList.remove('active');
                        updateUIForLoggedInUser();
                        showProfile();
                    }, 1000);
                }
            }
            
            // 重置表单
            document.getElementById('userForm').reset();
        }

        // 处理个人设置表单提交
        function handleProfileSettingsSubmit(e) {
            e.preventDefault();
            if (currentUser) {
                currentUser.email = document.getElementById('profileEmail').value;
                // 更新存储的用户数据
                if (usersData[currentUser.username]) {
                    usersData[currentUser.username].email = currentUser.email;
                    localStorage.setItem('usersData', JSON.stringify(usersData));
                }
                // 更新记忆的用户数据
                localStorage.setItem('rememberedUser', JSON.stringify(currentUser));
                alert('设置保存成功！');
            }
        }

        // 处理退出登录
        function handleLogout() {
            if (confirm('确定要退出登录吗？')) {
                currentUser = null;
                document.getElementById('userBtn').innerHTML = '<i class="fas fa-user"></i> 登录/注册';
                
                // 清除记忆的登录状态
                localStorage.removeItem('rememberedUser');
                
                hideProfile();
                alert('已成功退出登录！');
            }
        }

        // 页面加载时检查主题设置
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-theme');
            document.querySelector('#themeToggle i').className = 'fas fa-sun';
        }
    </script>
</body>
</html>
